#!/usr/bin/env bash

set -euo pipefail

function install_yay() {
  local yay_url="https://aur.archlinux.org/yay.git"
  local yay_dir="/tmp/yay"
  git clone "$yay_url" "$yay_dir"
  cd "$yay_dir"
  makepkg --syncdeps --install
  yay -Syyu --no-confirm
}

function install_pacman_packages() {
  yay -S "$(cat "$setup_dir/share/arch/packages")"
}

function install_gnome() {
  sudo pacman -S gnome
  sudo systemctl enable gdm
}

function upgrade_system() {
  sudo pacman -Syyu
}

function install_docker() {
  sudo pacman -S docker

  sudo systemctl enable docker
}

current_dir=$(diname "$(readlink -f "${BASH_SOURCE[0]}")")
setup_dir="${current_dir}/.."

source "${setup_dir}/lib/utils.sh"

upgrade_system
# install_gnome
install_yay
install_pacman_packages
